import ReactECharts from "echarts-for-react";
import { graphic } from "echarts";
import { useState } from "react";
import { RadioGroup, RadioGroupItem } from "@components/shadcn/radio-group";
import { Label } from "@components/shadcn/label";
import dayjs from "dayjs";

function PortfolioHistory() {
  const [chartFilter, setChartFilter] = useState<"7" | "30" | "90" | "365">("7");
  

  const data = {
    "2023-02-17": 15246288.926079998,
    "2023-02-18": 15384887.41402,
    "2023-02-19": 15022963.98443,
    "2023-02-20": 14729525.593549998,
    "2023-02-21": 14466962.312100003,
    "2023-02-22": 14056692.10407,
    "2023-02-23": 14433530.625929998,
    "2023-02-24": 14314227.3208,
    "2023-02-25": 14182105.51058,
    "2023-02-26": 14332648.7743,
    "2023-02-27": 13431482.17685,
    "2023-02-28": 13126181.406680001,
    "2023-03-01": 13829799.45085,
    "2023-03-02": 13683386.663549999,
    "2023-03-03": 12995954.87738,
    "2023-03-04": 13068674.23787,
    "2023-03-05": 12999197.100100001,
    "2023-03-06": 13389046.19444,
    "2023-03-07": 13627208.102279998,
    "2023-03-08": 13647389.96066,
    "2023-03-09": 13088415.8456,
    "2023-03-10": 11734000.22074,
    "2023-03-11": 11222432.21467,
    "2023-03-12": 11935508.463299999,
    "2023-03-13": 12672118.583479999,
    "2023-03-14": 13722994.8884,
    "2023-03-15": 13357102.334700001,
    "2023-03-16": 13313532.7371,
    "2023-03-17": 13518331.088549998,
    "2023-03-18": 12933351.76924,
    "2023-03-19": 12939344.195999999,
    "2023-03-20": 12271116.66223,
    "2023-03-21": 12189941.151150001,
    "2023-03-22": 11904201.63028,
    "2023-03-23": 12339359.891360002,
    "2023-03-24": 12598947.882100001,
    "2023-03-25": 12626427.834060002,
    "2023-03-26": 12661060.512740001,
    "2023-03-27": 12601980.377220001,
    "2023-03-28": 11547369.342179999,
    "2023-03-29": 11799236.2963,
    "2023-03-30": 11222269.544499999,
    "2023-03-31": 11430509.442019999,
    "2023-04-01": 11684471.31744,
    "2023-04-02": 11478954.34264,
    "2023-04-03": 11338086.70642,
    "2023-04-04": 11349171.22206,
    "2023-04-05": 11364165.01437,
    "2023-04-06": 11358773.469530001,
    "2023-04-07": 11309646.35844,
    "2023-04-08": 11317680.41507,
    "2023-04-09": 11399316.2782,
    "2023-04-10": 11830906.9532,
    "2023-04-11": 13411135.990279999,
    "2023-04-12": 12837798.09385,
    "2023-04-13": 12251964.4992,
    "2023-04-14": 12467164.8596,
    "2023-04-15": 12665417.931249999,
    "2023-04-16": 12656152.81838,
    "2023-04-17": 12669466.737620002,
    "2023-04-18": 12746333.748660002,
    "2023-04-19": 12684584.79445,
    "2023-04-20": 12547640.62878,
    "2023-04-21": 14619447.0167,
    "2023-04-22": 13863572.60128,
    "2023-04-23": 13925821.2247,
    "2023-04-24": 14237367.08617,
    "2023-04-25": 16876669.3387,
    "2023-04-26": 16757432.233969998,
    "2023-04-27": 18767155.791300002,
    "2023-04-28": 18186141.5539,
    "2023-04-29": 16841776.11723,
    "2023-04-30": 16645960.27197,
    "2023-05-01": 15477801.775759999,
    "2023-05-02": 12774971.728500001,
    "2023-05-03": 12495303.307039998,
    "2023-05-04": 11767962.640270002,
    "2023-05-05": 12041075.48915,
    "2023-05-06": 12012157.76835,
    "2023-05-07": 11692703.66495,
    "2023-05-08": 10906691.02197,
    "2023-05-09": 10744727.731279999,
    "2023-05-10": 11005732.016520001,
    "2023-05-11": 10700038.194600001,
    "2023-05-12": 10900040.60704,
    "2023-05-13": 10970670.0791,
    "2023-05-14": 11024990.13757,
    "2023-05-15": 11427892.813500002,
    "2023-05-16": 12305105.296799999,
    "2023-05-17": 12232349.35427,
    "2023-05-18": 11783954.075000001,
    "2023-05-19": 12409761.11135,
    "2023-05-20": 12402274.86254,
    "2023-05-21": 12342372.5899,
    "2023-05-22": 12794588.45277,
    "2023-05-23": 12890437.20928,
    "2023-05-24": 13764424.70197,
    "2023-05-25": 13695730.069769999,
    "2023-05-26": 12963931.45145,
    "2023-05-27": 13260232.05927,
    "2023-05-28": 13186813.688270003,
    "2023-05-29": 12992909.456549998,
    "2023-05-30": 12916728.78335,
    "2023-05-31": 12804679.945,
    "2023-06-01": 12246746.03265,
    "2023-06-02": 12506744.9767,
    "2023-06-03": 12366198.4298,
    "2023-06-04": 12818327.88894,
    "2023-06-05": 12210406.828200001,
    "2023-06-06": 14032834.583999999,
    "2023-06-07": 14814202.3953,
    "2023-06-08": 14910105.2247,
    "2023-06-09": 14876786.161700001,
    "2023-06-10": 14402593.44204,
    "2023-06-11": 14725381.1348,
    "2023-06-12": 14642537.5373,
    "2023-06-13": 14311805.42294,
    "2023-06-14": 14547014.631930001,
    "2023-06-15": 16098819.08614,
    "2023-06-16": 16070829.33534,
    "2023-06-17": 15957797.36062,
    "2023-06-18": 16168242.756800001,
    "2023-06-19": 16198268.5587,
    "2023-06-20": 16864792.463800002,
    "2023-06-21": 17352134.9098,
    "2023-06-22": 17392413.5072,
    "2023-06-23": 17547085.273399998,
    "2023-06-24": 17954843.10187,
    "2023-06-25": 14845116.31182,
    "2023-06-26": 14558736.2372,
    "2023-06-27": 15098673.25377,
    "2023-06-28": 14885475.07656,
    "2023-06-29": 15266565.195179999,
    "2023-06-30": 14630765.91472,
    "2023-07-01": 15148704.21928,
    "2023-07-02": 14164750.143570002,
    "2023-07-03": 14589523.032130001,
    "2023-07-04": 14110243.13672,
    "2023-07-05": 14048935.291299999,
    "2023-07-06": 14218582.725100001,
    "2023-07-07": 14345982.36985,
    "2023-07-08": 14298095.01557,
    "2023-07-09": 14457987.07726,
    "2023-07-10": 14595234.258330002,
    "2023-07-11": 14550150.0353,
    "2023-07-12": 14301260.53974,
    "2023-07-13": 15115085.65794,
    "2023-07-14": 14638397.00313,
    "2023-07-15": 14776651.208129998,
    "2023-07-16": 14943631.478969999,
    "2023-07-17": 14292463.281820001,
    "2023-07-18": 13884952.76787,
    "2023-07-19": 13641574.130040001,
    "2023-07-20": 13256679.474200001,
    "2023-07-21": 13325920.854100002,
    "2023-07-22": 13501864.01642,
    "2023-07-23": 13514395.536199998,
    "2023-07-24": 12959781.939480001,
    "2023-07-25": 13691448.834899997,
    "2023-07-26": 13452654.30118,
    "2023-07-27": 13508090.78316,
    "2023-07-28": 13583973.5945,
    "2023-07-29": 13746439.799714003,
    "2023-07-30": 13956286.1145145,
    "2023-07-31": 13670192.1687517,
    "2023-08-01": 13149695.324474102,
    "2023-08-02": 13013286.6500451,
    "2023-08-03": 13553499.0798317,
    "2023-08-04": 13580354.902870003,
    "2023-08-05": 13755197.705602396,
    "2023-08-06": 13816126.377974,
    "2023-08-07": 13732330.8001688,
    "2023-08-08": 13393536.1633526,
    "2023-08-09": 13244600.438798299,
    "2023-08-10": 13098769.047135502,
    "2023-08-11": 12942945.068733899,
    "2023-08-12": 12811150.5471028,
    "2023-08-13": 12806895.6474253,
    "2023-08-14": 12918373.194792101,
    "2023-08-15": 12402622.8099077,
    "2023-08-16": 11919566.603464201,
    "2023-08-17": 11605420.055011502,
    "2023-08-18": 11656239.5277517,
    "2023-08-19": 11918052.730739398,
    "2023-08-20": 11893397.488734199,
    "2023-08-21": 12095004.2511412,
    "2023-08-22": 11527746.4942829,
    "2023-08-23": 11764360.0066693,
    "2023-08-24": 11859182.7635094,
    "2023-08-25": 11842020.2710186,
    "2023-08-26": 11891924.6211791,
    "2023-08-27": 11657480.074512301,
    "2023-08-28": 11538246.731218698,
    "2023-08-29": 11572311.138225,
    "2023-08-30": 11614851.8815713,
    "2023-08-31": 11831832.930257699,
    "2023-09-01": 11805307.616819702,
    "2023-09-02": 11714817.355437,
    "2023-09-03": 11820055.375077398,
    "2023-09-04": 11469436.7327025,
    "2023-09-05": 11309065.1119284,
    "2023-09-06": 11325389.411486698,
    "2023-09-07": 11426631.253525728,
    "2023-09-08": 11620322.406569032,
    "2023-09-09": 11480777.746177003,
    "2023-09-10": 11590603.516426802,
    "2023-09-11": 11812252.423408551,
    "2023-09-12": 11656330.0457479,
    "2023-09-13": 11597215.225592203,
    "2023-09-14": 11647568.868856331,
    "2023-09-15": 16173511.810086949,
    "2023-09-16": 9201780.354508102,
    "2023-09-17": 9383278.189760339,
    "2023-09-18": 9410027.0568113,
    "2023-09-19": 16541810.3589926,
    "2023-09-20": 12136927.1110225,
    "2023-09-21": 12258665.8707959,
    "2023-09-22": 12004854.1045183,
    "2023-09-23": 11983853.24769327,
    "2023-09-24": 12008599.87660126,
    "2023-09-25": 12187831.402917253,
    "2023-09-26": 12293038.205594,
    "2023-09-27": 12589280.9438694,
    "2023-09-28": 11455687.339696003,
    "2023-09-29": 11422963.6250618,
    "2023-09-30": 11606944.784241902,
    "2023-10-01": 11750744.6089109,
    "2023-10-02": 11677899.7997774,
    "2023-10-03": 11993687.6214259,
    "2023-10-04": 11553367.617618801,
    "2023-10-05": 11460728.4879192,
    "2023-10-06": 11459511.5631327,
    "2023-10-07": 11581480.9422243,
    "2023-10-08": 11652712.140570702,
    "2023-10-09": 11912406.7471554,
    "2023-10-10": 12471513.796635602,
    "2023-10-11": 11742190.3844215,
    "2023-10-12": 11873534.799829498,
    "2023-10-13": 12141272.1781687,
    "2023-10-14": 12204077.0089472,
    "2023-10-15": 12510092.065985901,
    "2023-10-16": 12815203.1340419,
    "2023-10-17": 12189247.363903899,
    "2023-10-18": 12132302.952643001,
    "2023-10-19": 12262538.177999299,
    "2023-10-20": 12094846.702479001,
    "2023-10-21": 12162085.8909581,
    "2023-10-22": 12262932.5415625,
    "2023-10-23": 11585435.7517507,
    "2023-10-24": 12087152.7876988,
    "2023-10-25": 12130521.670093399,
    "2023-10-26": 11797384.116702901,
    "2023-10-27": 12527738.5132022,
    "2023-10-28": 12834404.9518332,
    "2023-10-29": 12003986.9678901,
    "2023-10-30": 12090135.0588424,
    "2023-10-31": 12323089.821166,
    "2023-11-01": 12225857.891738899,
    "2023-11-02": 12969969.424969299,
    "2023-11-03": 16563561.6646473,
    "2023-11-04": 16379885.445895402,
    "2023-11-05": 15827911.390193,
    "2023-11-06": 17732311.064987898,
    "2023-11-07": 20299182.3675483,
    "2023-11-08": 22487857.956716597,
    "2023-11-09": 22139443.8135652,
    "2023-11-10": 21803385.2950272,
    "2023-11-11": 20467396.0211783,
    "2023-11-12": 19914140.427797697,
    "2023-11-13": 20573555.611817103,
    "2023-11-14": 18841512.669685,
    "2023-11-15": 21266085.558610503,
    "2023-11-16": 22831110.3434141,
    "2023-11-17": 24559091.786557205,
    "2023-11-18": 24828727.1609456,
    "2023-11-19": 23656534.8279072,
    "2023-11-20": 22557251.2013054,
    "2023-11-21": 24020095.1522532,
    "2023-11-22": 15346976.166949501,
    "2023-11-23": 15877605.405460099,
    "2023-11-24": 16912941.8095693,
    "2023-11-25": 18887359.584855802,
    "2023-11-26": 18782883.087876603,
    "2023-11-27": 19699638.4677514,
    "2023-11-28": 19916161.787230205,
    "2023-11-29": 20838656.864488102,
    "2023-11-30": 21609809.0689526,
    "2023-12-01": 22417329.3328972,
    "2023-12-02": 21920328.52639,
    "2023-12-03": 20444175.6605866,
    "2023-12-04": 19773061.7594835,
    "2023-12-05": 19300512.523963697,
    "2023-12-06": 19797895.782325998,
    "2023-12-07": 18355824.170052804,
    "2023-12-08": 18719907.889371604,
    "2023-12-09": 18281052.773566898,
    "2023-12-10": 17425477.581693504,
    "2023-12-11": 16575236.602812799,
    "2023-12-12": 17742014.217212003,
    "2023-12-13": 17221106.728722896,
    "2023-12-14": 15798958.934759198,
    "2023-12-15": 15828593.867950998,
    "2023-12-16": 16793318.927525904,
    "2023-12-17": 16049999.2981457,
    "2023-12-18": 15438255.893130299,
    "2023-12-19": 15920045.0398458,
    "2023-12-20": 17060133.4748468,
    "2023-12-21": 17594161.3046125,
    "2023-12-22": 16988427.4114876,
    "2023-12-23": 16294008.189186199,
    "2023-12-24": 16416600.804646999,
    "2023-12-25": 16235337.5136207,
    "2023-12-26": 16098099.770695101,
    "2023-12-27": 15594626.8186006,
    "2023-12-28": 12952690.4092473,
    "2023-12-29": 13095966.790306702,
    "2023-12-30": 12877851.3814056,
    "2023-12-31": 15970955.063569598,
    "2024-01-01": 15154446.082315398,
    "2024-01-02": 14933935.298329597,
    "2024-01-03": 14247869.0255591,
    "2024-01-04": 14150056.587002302,
    "2024-01-05": 13581654.0233502,
    "2024-01-06": 12618034.8333204,
    "2024-01-07": 12446774.861925201,
    "2024-01-08": 12395454.293699298,
    "2024-01-10": 11934298.6873234,
    "2024-01-11": 12665857.197918002,
    "2024-01-12": 12172937.7685812,
    "2024-01-13": 11832229.034035802,
    "2024-01-14": 11587065.260089701,
    "2024-01-15": 11836096.1042312,
    "2024-01-16": 12666297.699279997,
    "2024-01-17": 13706372.6107752,
    "2024-01-18": 14326717.138075499,
    "2024-01-19": 13225805.121879801,
    "2024-01-20": 12699246.314480398,
    "2024-01-21": 12700833.744103398,
    "2024-01-22": 12628145.9292357,
    "2024-01-23": 11778421.091699302,
    "2024-01-24": 12282037.682876,
    "2024-01-25": 12005486.3711257,
    "2024-01-26": 11718048.683367802,
    "2024-01-27": 11922822.821004601,
    "2024-01-28": 11678878.115725601,
    "2024-01-29": 11420847.863642901,
    "2024-01-30": 11284180.629985198,
    "2024-01-31": 11135425.380395401,
    "2024-02-01": 10970171.360084899,
    "2024-02-02": 11456494.613942001,
    "2024-02-03": 11760981.8464076,
    "2024-02-04": 11634056.9948982,
    "2024-02-05": 11221359.2866472,
    "2024-02-06": 11180111.1440663,
    "2024-02-07": 11238479.382678,
    "2024-02-08": 11819109.6106918,
    "2024-02-09": 11902731.174720101,
    "2024-02-10": 11730114.357278,
    "2024-02-11": 11811945.2579305,
    "2024-02-12": 12833479.640340598,
    "2024-02-13": 12967704.5504861,
    "2024-02-14": 12977907.7353407,
    "2024-02-15": 12655632.069553299,
    "2024-02-16": 12073088.491658002
}
  const formattedData= Object.entries(data);
  const portfolioHistory = {
    tooltip: {
      backgroundColor: "#15202B",
      borderColor: "#384555",
      axisPointer: {
        type: "shadow",
      },
      textStyle: {
        color: "#F8F8F8",
        fontFamily: "Geist Sans,system-ui",
        fontWeight: "600",
      },
      trigger: "axis",

      
      formatter: function (params: any) {  // eslint-disable-line @typescript-eslint/no-explicit-any
        const formattedDate =dayjs(params[0].data[0]).format("DD-MMM-YYYY");
        let content = formattedDate + "<br/>";
        for (let i = 0; i < params.length; i++) {
          content += '<div style="display: flex; justify-content: space-between; max-width: 200px;font-weight:medium">';
          content += '<div style="padding-right:10px" >' + params[i].marker + params[i].seriesName  + "</div>";
          content += Intl.NumberFormat("en", {
            notation: "compact",
            currency: "USD",
            style: "currency",
            maximumFractionDigits: 2,
          }).format(params[i].value[1]);
          content += "</div>";
        }
        return content;
      },
    },
    title: {
      show: false,
    },
    toolbox: {
      show: false,
    },
    xAxis: {
      type: "time",
      axisLine: {
        show: false,
      },
      axisLabel: {
        fontSize: 10,
        margin: 14,
        
        // interval: 5,
        align: "center",
        showMinLabel: true,
        showMaxLabel: true,
        hideOverlap: true,
        
        formatter: function (value: string) {
          if (chartFilter === "7") {
            return dayjs(value).format("ddd");
          }
          if (chartFilter === "30" || chartFilter === "90") {
            return dayjs(value).format("D MMM");
          }
          return dayjs(value).format("MMM,YY");
        },
      },
    },
    yAxis: {
      splitNumber: 5,
      type: "value",
      axisLabel: {
        formatter: (value: number) =>
          Intl.NumberFormat("en", {
            notation: "compact",
            currency: "USD",
            style: "currency",
            maximumFractionDigits: 0,
          }).format(value),
        fontSize: 10,
        fontFamily: "Geist Sans,system-ui",
        margin: 12,
      },
      splitLine: {
        show: false,
      },
    },
    dataZoom: [
      {
        type: "inside",
        disabled: true
      },
    ],
    series: [
      {
        name: "Balance:",
        type: "line",
        showSymbol: false,
        lineStyle: {
          width: 1,
        },
        labelLine: {
          smooth: true,
        },
        sampling: "lttb",
        itemStyle: {
          color: "rgba(255, 115, 72, 0.48)",
        },
        areaStyle: {
          color: new graphic.LinearGradient(0, 0, 0, 1, [
            {
              offset: 0,
              color: "rgba(255, 115, 72, 1)",
            },
            {
              offset: 1,
              color: "rgba(255, 115, 72, 0.1)",
            },
          ]),
        },
        data: formattedData.slice(Math.max(formattedData.length - Number(chartFilter), 0)).map(([key, value]) =>  [key,value]),
        // markPoint: {
        //   data: events,
        //   symbol: "diamond",
        //   symbolSize: 15,
        //   symbolOffset: [0, -5],
        //   label: {
        //     show: false,
        //   },
        //   itemStyle: {
        //     color: "rgba(255, 115, 72, 1)",
        //     shadowBlur: 1,
        //   },
        //   emphasis: {
        //     disabled: false,
        //     label: {
        //       show: true,
        //       position: "top",
        //       distance: 10,
        //       fontWeight: "600",
        //       fontSize: 14,
        //       color: "rgba(255, 115, 72, 1)",
        //       fontFamily: "Inter Variable,sans-serif",
        //       align: "center",
        //       formatter: "{c}",
        //     },
        //   },
        // },
      },
    ],
    grid: {
      show: false,
      top: "20",
      left: "40",
      right: "5",
      bottom: "30",
    },
    media:[{
      query:{
        maxWidth: 640,
      },
      option:{
        yAxis:{
          show:false
        },
        grid:{
          left: "10",
        }
      }
    }]
  };
  const handleRadioChange = (value: "7" | "30" | "90" | "365") => {
    setChartFilter(value);
  };
 
  return (
    <div className="bg-darkBlue rounded-xl p-3 w-full h-[360px] border overflow-hidden">
      <h3 className="text-center font-medium text-sm text-whitish">Portfolio History</h3>
      <RadioGroup defaultValue={chartFilter} className="flex items-center justify-center mt-1 xxs:mt-0  xxs:justify-end gap-4" onValueChange={handleRadioChange}>
        <div className="flex items-center">
          <RadioGroupItem value="7" id="week" className="peer hidden" />
          <Label
            htmlFor="week"
            className="text-whitish font-semibold text-xs cursor-pointer peer-data-[state=checked]:text-brand hover:text-brand transition-all ease-in duration-200"
          >
            1W
          </Label>
        </div>
        <div className="flex items-center">
          <RadioGroupItem value="30" id="month" className="peer hidden" />
          <Label
            htmlFor="month"
            className="text-whitish font-semibold text-xs cursor-pointer peer-data-[state=checked]:text-brand hover:text-brand transition-all ease-in duration-200"
          >
            1M
          </Label>
        </div>
        <div className="flex items-center">
          <RadioGroupItem value="90" id="quart" className="peer hidden" />
          <Label
            htmlFor="quart"
            className="text-whitish font-semibold text-xs cursor-pointer peer-data-[state=checked]:text-brand hover:text-brand transition-all ease-in duration-200"
          >
            3M
          </Label>
        </div>
        <div className="flex items-center">
          <RadioGroupItem value="365" id="year" className="peer hidden" />
          <Label
            htmlFor="year"
            className="text-whitish font-semibold text-xs cursor-pointer peer-data-[state=checked]:text-brand hover:text-brand transition-all ease-in duration-200"
          >
            1Y
          </Label>
        </div>
      </RadioGroup>
      <ReactECharts lazyUpdate={true} opts={{ renderer: "svg" }} option={portfolioHistory} className="w-full h-full object-cover" />
    </div>
  );
}

export default PortfolioHistory;
